---
kind: pipeline
name: default

concurrency:
  limit: 1

steps:
- name: sync
  image: alpine/git:latest
  commands:
    - git clone https://github.com/owncloud-ansible/playground --branch docs --single-branch content/getting_started
    - git clone https://github.com/owncloud-ansible/owncloud --branch docs --single-branch content/role/owncloud
    - git clone https://github.com/owncloud-ansible/redis --branch docs --single-branch content/role/redis
    - git clone https://github.com/owncloud-ansible/php --branch docs --single-branch content/role/php
    - git clone https://github.com/owncloud-ansible/mariadb --branch docs --single-branch content/role/mariadb
    - git clone https://github.com/owncloud-ansible/apache --branch docs --single-branch content/role/apache

- name: build
  image: klakegg/hugo:0.59.1-ext-alpine
  commands:
    - hugo-official

- name: publish
  image: plugins/gh-pages:latest
  settings:
    username:
      from_secret: github_username
    password:
      from_secret: github_token
    pages_directory: public/
    target_branch: master
  when:
    ref:
      - refs/heads/source

trigger:
  ref:
  - refs/heads/source
  - refs/pull/**
---
kind: signature
hmac: 2aa7c9b9490ff9bf238747f9ca940cdbcc31bbb92a05d8fea5ce79d4545cde43

...
